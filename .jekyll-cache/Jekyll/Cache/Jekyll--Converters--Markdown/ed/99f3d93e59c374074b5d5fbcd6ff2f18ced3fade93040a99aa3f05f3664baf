I"^<p>I had an interesting problem recently:</p>

<blockquote>
  <p>An application makes http requests on predfined events to a specified url and we need to verify what exactly is
being sent.</p>
</blockquote>

<p>There are many ways to deal with that, from dumping outgoing request objects to listening in on outgoing traffic with
Wireshark. But I have been a fan of <code class="highlighter-rouge">nmap</code> and its toolset, so I though that I would be a good opportunity to employ
<code class="highlighter-rouge">ncat</code> – an <code class="highlighter-rouge">netcat</code> reimplementation shipped with <code class="highlighter-rouge">nmap</code>.</p>

<p><code class="highlighter-rouge">ncat</code>, is as it precursor <code class="highlighter-rouge">nc</code>, a “Swiss Army Knife” (see <code class="highlighter-rouge">man nc</code>) of network tools. One of the many things it can do
is to listen for incoming traffic and print it to StdOut. So all I needed to do is to point the app to a url with <code class="highlighter-rouge">ncat</code>
listening.</p>

<p>The setup I have for development is a Vagrant box within a *nix compatible system (the shiny one).</p>

<p>Setting up <code class="highlighter-rouge">ncat</code> on the host system is straightforward enough:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ncat -lk 0.0.0.0 7777
</code></pre></div></div>

<p><code class="highlighter-rouge">-l</code> is for listen, <code class="highlighter-rouge">-k</code> is for keep-alive, <code class="highlighter-rouge">0.0.0.0</code> points to localhost in a way that will make it possible to connect
to it from the outside world, <code class="highlighter-rouge">7777</code> is the host post number.</p>

<p>To access that from the VM, we need an address. I have Vagrant set up a private network, so my host machine acts as a
gateway for the guest system. So I need the gateway address:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat -rn 
</code></pre></div></div>

<p>and look for a gateway that is not pointing to localhost :). In my case it is <code class="highlighter-rouge">10.0.2.2</code>, might be a standard for
Vagrant boxes, but I am not sure. Now I know I need to ping <code class="highlighter-rouge">10.0.2.2:7777</code> from my guest system to reach my <code class="highlighter-rouge">ncat</code> listener on the host
system:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -X POST 10.0.2.2:7777 --data '{"hello": "world"}'
</code></pre></div></div>

<p><code class="highlighter-rouge">ncat</code> ouput on the host machine:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ncat -lk 0.0.0.0 7777
POST / HTTP/1.1
User-Agent: curl/7.38.0
Host: 10.0.2.2:7777
Accept: */*
Content-Length: 18
Content-Type: application/x-www-form-urlencoded

{"hello": "world"}
</code></pre></div></div>

<p>This way I know it works.</p>

<p>All that was left was to put that <code class="highlighter-rouge">ncat</code> listener address in place of the target url in the app and done!</p>
:ET